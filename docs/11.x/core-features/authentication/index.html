<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-11.x docs-doc-page docs-doc-id-core-features/authentication" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Authentication | Apiato</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://apiato.io/docs/11.x/core-features/authentication"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="11.x"><meta data-rh="true" name="docusaurus_tag" content="docs-default-11.x"><meta data-rh="true" name="docsearch:version" content="11.x"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-11.x"><meta data-rh="true" property="og:title" content="Authentication | Apiato"><meta data-rh="true" name="description" content="- API Authentication (OAuth 2.0)"><meta data-rh="true" property="og:description" content="- API Authentication (OAuth 2.0)"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://apiato.io/docs/11.x/core-features/authentication"><link data-rh="true" rel="alternate" href="https://apiato.io/docs/11.x/core-features/authentication" hreflang="en"><link data-rh="true" rel="alternate" href="https://apiato.io/docs/11.x/core-features/authentication" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://OZKEC9E27Y-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.d96cc79e.css">
<script src="/assets/js/runtime~main.81d36e3c.js" defer="defer"></script>
<script src="/assets/js/main.0a4f6c1d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">If you like Apiato, give it a ‚≠êÔ∏è on <a target="_blank" rel="noopener noreferrer" href="https://github.com/apiato/apiato">GitHub</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Apiato Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="Apiato Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Apiato</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/11.x/getting-started/installation">Docs</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/11.x/core-features/authentication">11.x</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/prologue/release-notes">Next üöß</a></li><li><a class="dropdown__link" href="/docs/prologue/release-notes">12.x</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/11.x/core-features/authentication">11.x</a></li><li><a class="dropdown__link" href="/docs/10.x/core-features/authentication">10.x</a></li><li><a class="dropdown__link" href="/docs/9.x/core-features/authentication">9.x</a></li></ul></div><a href="https://github.com/apiato/apiato" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><a href="https://discord.com/invite/ryPcV4KM5k" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discord-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/11.x/">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/11.x/core-features/code-generator">Features</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/11.x/core-features/code-generator">Core Features</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/code-generator">Code Generator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/11.x/core-features/authentication">Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/authorization">Authorization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/user-registration">User Registration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/query-parameters">Query Parameters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/default-endpoints">Default Endpoints</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/hash-id">Hash ID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/rate-limiting">Rate Limiting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/data-caching">Data Caching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/pagination">Pagination</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/api-versioning">API Versioning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/validation">Validation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/etag">ETag</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/useful-commands">Useful Commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/11.x/core-features/profiler">Profiler</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/11.x/additional-features/overview">Additional Features</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/11.x/main-components/routes">Components</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/11.x/miscellaneous/tests-helpers">Miscellaneous</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/11.x/upgrade-guide">Upgrade Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/11.x/contribution-guide">Contribution Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/11.x/faq">Frequently Asked Questions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://github.com/apiato/apiato/releases" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK">Change Log<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Apiato<!-- --> <b>11.x</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/prologue/release-notes">latest version</a></b> (<!-- -->12.x<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Features</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Core Features</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Authentication</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 11.x</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Authentication</h1></header><ul>
<li><a href="#api-authentication-oauth-20">API Authentication (OAuth 2.0)</a></li>
<li><a href="#how-to-get-access-token-using-oauth-20">How to get Access Token using OAuth 2.0</a></li>
<li><a href="#quick-overview">Quick Overview</a>
<ul>
<li><a href="#first-party-clients">A: For first-party clients</a>
<ul>
<li><a href="#login-with-proxy-for-first-party-clients">Login with Proxy for first-party clients</a></li>
<li><a href="#login-without-proxy-for-first-party-clients">Login without Proxy for first-party clients</a></li>
</ul>
</li>
<li><a href="#third-party-clients">B: For third-party clients</a>
<ul>
<li><a href="#login-without-proxy-for-third-party-clients">Login without Proxy for third-party clients</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#login-with-custom-attributes">Login With Custom Attributes</a></li>
<li><a href="#logout">Logout</a></li>
<li><a href="#responses">Responses</a></li>
<li><a href="#change-tokens-expiration-dates">Change Tokens Expiration dates</a></li>
<li><a href="#web-authentication">Web Authentication</a></li>
<li><a href="#refresh-token">Refresh Token</a>
<ul>
<li><a href="#refresh-token-with-proxy-for-first-party-clients">Refresh Token with proxy for first-party clients</a></li>
<li><a href="#refresh-token-without-proxy-for-first-party-or-third-party-clients">Refresh Token without proxy for first-party or third-party clients</a></li>
</ul>
</li>
<li><a href="#email-verification">Email Verification</a></li>
<li><a href="#reset-password">Reset Password</a></li>
<li><a href="#social-authentication">Social Authentication</a></li>
</ul>
<p>Middlewares are the best solution to apply Authentication in your App.</p>
<p>In Apiato you can use these two <code>Authentication Middlewares</code>, to protect your endpoints:</p>
<ul>
<li>API Authentication: <code>auth:api</code></li>
<li>Web Authentication: <code>auth:web</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="api-authentication-oauth-20">API Authentication (OAuth 2.0)<a href="#api-authentication-oauth-20" class="hash-link" aria-label="Direct link to API Authentication (OAuth 2.0)" title="Direct link to API Authentication (OAuth 2.0)">‚Äã</a></h2>
<p>To protect an <strong>API</strong> Endpoint from being accessible by unauthenticated users you can use the <code>auth:api</code> Middleware.</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token scope">Route</span><span class="token scope punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;secret/info&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token scope">Controller</span><span class="token scope punctuation" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;getSecretInfo&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">middleware</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;auth:api&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>All Endpoints protected with <code>auth:api</code> are accessible only when sending them a valid access token.</p>
<p>This Middleware is provided by the <a href="https://laravel.com/docs/passport" target="_blank" rel="noopener noreferrer">Laravel Passport</a> package. So you can read its
documentation for more details.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-get-access-token-using-oauth-20">How to get Access Token using OAuth 2.0<a href="#how-to-get-access-token-using-oauth-20" class="hash-link" aria-label="Direct link to How to get Access Token using OAuth 2.0" title="Direct link to How to get Access Token using OAuth 2.0">‚Äã</a></h2>
<ol>
<li>
<p>Generate <code>client_id</code> &amp; <code>client_secret</code>. (<a href="#first-party-clients">more details</a>)</p>
</li>
<li>
<p>Use the generated client to call this oauth/token endpoint <code>http://api.apiato.test/v1/oauth/token</code></p>
</li>
</ol>
<p>All the Auth Endpoints are documented. Go to <a href="/docs/11.x/additional-features/documentation">Documentation Generator Page</a>
to see how you can generate the API documentation, and read them.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quick-overview">Quick Overview<a href="#quick-overview" class="hash-link" aria-label="Direct link to Quick Overview" title="Direct link to Quick Overview">‚Äã</a></h2>
<p>OAuth lets you authenticate using different methods, these methods are called <code>grants</code>.
For how to decide which grant type you should use, check <a href="https://oauth2.thephpleague.com/authorization-server/which-grant/" target="_blank" rel="noopener noreferrer">this</a>
and keep reading this documentation.</p>
<p><strong>Definitions:</strong></p>
<ul>
<li>The Client credentials: are the <code>client_id</code> &amp; <code>client_secret</code>.</li>
<li>The Proxy: is just an endpoint, that you should call instead of calling the Auth server endpoints directly, the proxy
endpoint will append the client credentials to your request and calls the Auth server for you, then return its response back. Each first-party client app should have its own proxy endpoints (at least one for each Login and Token Refresh). By default, Apiato provide a <code>Web Client</code> proxy endpoint.</li>
</ul>
<blockquote>
<p>You can Log in to the first party app with proxy or without proxy, while for the third party you only need to log in
without proxy. (same apply to refreshing token).</p>
<p>For first party apps:</p>
<ul>
<li>With Proxy &lt; best and easiest way, (requires manually generating clients creating proxy endpoints for each client)</li>
<li>Without Proxy &lt; if your frontend is not exposing the client credentials, you can call the Auth server endpoints directly without proxy.</li>
</ul>
<p>For third party apps:</p>
<ul>
<li>Without Proxy &lt; you don&#x27;t need a proxy for the third party clients as they usually integrate with your API from the backend side which protects the client credentials.</li>
</ul>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="first-party-clients">A: For first-party clients<a href="#first-party-clients" class="hash-link" aria-label="Direct link to A: For first-party clients" title="Direct link to A: For first-party clients">‚Äã</a></h2>
<p>First-party clients (Your Frontend Mobile, Web,... Apps) usually consumes your private API (Internal API).</p>
<p>For first-party clients you need to use the <strong>Resource owner credentials grant</strong> (A.K.A. Password Grant Tokens).</p>
<p>When this grant type is used, your server needs to authenticate the Client App first (ensuring the request is coming
from your trusted frontend App) and then needs to check if the user credentials are correct (ensuring the user is
registered and has the right access), before issuing an access token.</p>
<p><strong>Note:</strong></p>
<ul>
<li>On register: the API returns user data. You will need to log that user in (using the same credentials he passed) to
get his Access Token and make other API calls.</li>
<li>On login: the API returns the user Access Token with Refresh Token. You will need to request the User data by making
another call to the user endpoint, using his Access Token.</li>
</ul>
<p><strong>How it works:</strong></p>
<ol>
<li>
<p>Create a password type Client in your database to represent one of your Apps (ex: Mobile App). Use
<code>php artisan passport:client --password</code> to generate the client.</p>
</li>
<li>
<p>After registration, the user can enter his (username + password) in your App login screen.</p>
</li>
<li>
<p>Your App should send a <strong>Post</strong> request to <code>http://api.apiato.test/v1/oauth/token</code> containing the user credentials
(<code>username</code> and <code>password</code>) and the client credentials (<code>client_id</code> and <code>client_secret</code>) in addition to the <code>scope</code>
and <code>grant_type=password</code>:</p>
</li>
</ol>
<p><strong>Request:</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--request</span><span class="token plain"> POST </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">--url</span><span class="token plain"> http://api.apiato.test/v1/oauth/token </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">--header</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;accept: application/json&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">--header</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;content-type: application/x-www-form-urlencoded&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">--data</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;username=admin%40admin.com&amp;password=admin&amp;client_id=2&amp;client_secret=SGUVv02b1ppQCgI7ZVeoTZDN6z8SSFLYiMOzzfiE&amp;grant_type=password&amp;scope=&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Response:</strong></p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;token_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Bearer&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;expires_in&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">86400</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;access_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUz...&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;refresh_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;TPSPA1S6H8Wydjkjl+xt+hPGWTagL...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>Your Client App should save the Tokens and start requesting secure data, by sending the Access Token in the HTTP
Header <code>Authorization = Bearer {Access-Token}</code>.</li>
</ol>
<p>More info at <a href="https://laravel.com/docs/passport#password-grant-tokens" target="_blank" rel="noopener noreferrer">Laravel Passport Here</a></p>
<blockquote>
<p>WARNING: the Client ID and Secret should not be stored in JavaScript or browser cache, or made accessible in any way.</p>
</blockquote>
<p>So in case of Web Apps (JavaScript) you need to hide your client credentials behind a proxy. Apiato by default
provides you with a Web Login Proxy to use for all your trusted first party clients. We&#x27;ll see below how you can use them.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="login-with-proxy-for-first-party-clients">Login with Proxy for first-party clients<a href="#login-with-proxy-for-first-party-clients" class="hash-link" aria-label="Direct link to Login with Proxy for first-party clients" title="Direct link to Login with Proxy for first-party clients">‚Äã</a></h3>
<p>Concept: create an endpoint for each trusted client, to be used for a login.</p>
<p>Apiato by default has one url ready for your Web client <code>clients/web/login</code>. You can add more as you
need for each of your trusted first party clients Apps (example: <code>clients/web/users/login</code>, <code>clients/mobile/users/login</code>).</p>
<p>Behind the scene, that endpoint is appending the corresponding client ID and Secret to your request and making another
call to your Auth server with all the required data. <em>(this way the client does not need to send the ID and Secret with
the request, and he is using his own URL which gives even more control to which client is accessing your Server)</em>. Then
it returns the Auth response back to the client with the Tokens in it.</p>
<p>Note: You have to manually extract the Client credentials from the DB and put them in the <code>.env</code>, for each client.</p>
<p>When running <code>passport:install</code> it automatically creates one client for you so you can use that for your
first app. Or you can use <code>php artisan passport:client --password</code> to generate them.</p>
<p><code>.env</code> Example:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CLIENT_WEB_ID=101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLIENT_WEB_SECRET=VkjYCUk5DUexJTE9yFAakytWCOqbShLgu9Ql67TI</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="login-without-proxy-for-first-party-clients">Login without Proxy for first-party clients<a href="#login-without-proxy-for-first-party-clients" class="hash-link" aria-label="Direct link to Login without Proxy for first-party clients" title="Direct link to Login without Proxy for first-party clients">‚Äã</a></h3>
<p>Login from your App by sending a POST request to <code>http://api.apiato.test/v1/oauth/token</code> with <code>grant_type=password</code>,
the User credentials (<code>username</code> &amp; <code>password</code>), Client Credentials (<code>client_id</code> &amp; <code>client_secret</code>) and finally the
<code>scope</code> which could be empty.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="third-party-clients">B: For third-party clients<a href="#third-party-clients" class="hash-link" aria-label="Direct link to B: For third-party clients" title="Direct link to B: For third-party clients">‚Äã</a></h2>
<p>Third party clients (User&#x27;s custom external Apps, who wants to integrate with your Software) always consumes your
public API (External API) only.</p>
<p>For third-party clients you need to use the <strong>Client credentials grant</strong> (A.K.A. Personal Access Tokens). <em>This grant
type is the simplest and is suitable for machine-to-machine authentication.</em></p>
<p>With this grant type your server needs to authenticate the Client App only, before issuing an access token.</p>
<p><strong>How it works</strong></p>
<ol>
<li>User logs in to your Clients App Interface (an external App made for your users only), go to settings, create Client
(of type <code>personal</code>) and copy the ID and Secret. <em>(Note this can be done via an API if you prefer)</em></li>
</ol>
<p>You may generate a personal client for testing purposes using <code>php artisan passport:client --personal</code>.</p>
<ol start="2">
<li>User add the Client credentials to his &quot;Server Side software&quot; and send a <strong>Post</strong> request to
<code>http://api.apiato.test/v1/oauth/token</code> containing the Client credentials (<code>client_id</code> and <code>client_secret</code>) in
addition to the <code>scope</code> and <code>grant_type=client_credentials</code>:</li>
</ol>
<p>Request:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--request</span><span class="token plain"> POST </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">--url</span><span class="token plain"> http://api.apiato.test/v1/oauth/token </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">--header</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;accept: application/json&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">--header</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;content-type: application/x-www-form-urlencoded&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">--data</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;client_id=1&amp;client_secret=y1RbtnOvh9rpA91zPI2tiVKmFlepNy9dhHkzUKle&amp;grant_type=client_credentials&amp;scope=&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Response:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;token_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Bearer&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;expires_in&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">86400</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;access_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1Ni...&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;refresh_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ZFDPA1S7H8Wydjkjl+xt+hPGWTagX...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>The Client will be granted an Access Token to be saved. Then the Client can start requesting secure data, by sending
the Access Token in the HTTP Header <code>Authorization = Bearer {Access-Token}</code>.</li>
</ol>
<p>More info at <a href="https://laravel.com/docs/passport#personal-access-tokens" target="_blank" rel="noopener noreferrer">Laravel Passport Here</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="login-without-proxy-for-third-party-clients">Login without Proxy for third-party clients<a href="#login-without-proxy-for-third-party-clients" class="hash-link" aria-label="Direct link to Login without Proxy for third-party clients" title="Direct link to Login without Proxy for third-party clients">‚Äã</a></h3>
<p>We usually do not need a proxy for third-party clients as they are most likely making calls form their servers, thus
the Client ID and Secret should be secure and not exposed to the users.</p>
<p>Login by sending a POST request to <code>http://api.apiato.test/v1/oauth/token</code> with <code>grant_type=client_credentials</code>,
Client Credentials (<code>client_id</code> &amp; <code>client_secret</code>) and finally the <code>scope</code> which could be empty.</p>
<p>Once issued, you can use that Access Token to make requests to protected resources (Endpoints).
The Access Token should be sent in the <code>Authorization</code> header of type <code>Bearer</code>
(Example: <code>Authorization = Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUz...</code>)</p>
<p><strong>Keep in mind there&#x27;s no session state when using Tokens for Authentication</strong></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="login-with-custom-attributes">Login With Custom Attributes<a href="#login-with-custom-attributes" class="hash-link" aria-label="Direct link to Login With Custom Attributes" title="Direct link to Login With Custom Attributes">‚Äã</a></h2>
<p>By default, Apiato allow users to log in with their <code>email</code> address. However, you may want to also allow users to
be able to log in using their <code>username</code>and <code>phone</code>.</p>
<p>Here is how to configure and use this feature.</p>
<ul>
<li>You may need to adapt your database accordingly (e.g., add the respective field to the <code>users</code> table).</li>
<li>You may need to adapt the <code>Task</code> that <code>create</code> a <code>User</code> object (e.g., the <code>CreateUserByCredentialsTask</code>) accordingly
to support the new fields. This may also affect your <code>Register</code> logic.</li>
<li>Check the <code>App\Containers\AppSection\Authentication\Configs\appSection-authentication</code> Configuration file and check the <code>login</code>
params in order to configure this feature.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="logout">Logout<a href="#logout" class="hash-link" aria-label="Direct link to Logout" title="Direct link to Logout">‚Äã</a></h2>
<p>Logout by sending a <code>DELETE</code> request to <code>http://api.apiato.test/v1/logout/</code> containing the Token in the Header.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Token revoked successfully.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="responses">Responses<a href="#responses" class="hash-link" aria-label="Direct link to Responses" title="Direct link to Responses">‚Äã</a></h2>
<p><strong>Authentication failed JSON response:</strong></p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;An Exception occurred when trying to authenticate the User.&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;errors&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Wrong Client ID or Secret:</strong></p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;error&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;invalid_client&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;error_description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Client authentication failed&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Client authentication failed&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Access Correct:</strong></p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;token_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Bearer&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;expires_in&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">86400</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;access_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tnJ1eXAiOiJKV1QiLCJhbGciOiJSUzI1Zx...&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;refresh_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ZFDPA1S7H8Wydjkjl+xt+hPGWTagX...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="change-tokens-expiration-dates">Change Tokens Expiration dates<a href="#change-tokens-expiration-dates" class="hash-link" aria-label="Direct link to Change Tokens Expiration dates" title="Direct link to Change Tokens Expiration dates">‚Äã</a></h2>
<p>Go to <code>app/Ship/Configs/apiato.php</code> config file and edit this:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">|--------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">| Access Token Expiration</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">|--------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">|</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">| In Days. Default to 3650 days = 10 years</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">|</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;expires-in&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">env</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;API_TOKEN_EXPIRES&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3650</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">|--------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">| Refresh Token Expiration</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">|--------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">|</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">| In Days. Default to 3650 days = 10 years</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">|</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;refresh-expires-in&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">env</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;API_REFRESH_TOKEN_EXPIRES&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3650</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To change from days to minutes you need to edit the <code>boot</code> function in <code>App\Containers\AppSection\Authentication\Providers\AuthProvider</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="web-authentication">Web Authentication<a href="#web-authentication" class="hash-link" aria-label="Direct link to Web Authentication" title="Direct link to Web Authentication">‚Äã</a></h2>
<p>To protect a <strong>Web</strong> Endpoint from being accessible by unauthenticated users you can use the <code>auth:web</code> Middleware.</p>
<p>Example:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token scope">Route</span><span class="token scope punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;private/page&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token scope">Controller</span><span class="token scope punctuation" style="color:#393A34">::</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;showPrivatePage&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">middleware</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;auth:web&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>If authentication failed, users will be redirected to a login page</strong></p>
<p>To change the login page view go to the config file <code>app/Containers/AppSection/Authentication/Configs/appSection-authentication.php</code>, and set the name of your login page there as follows:</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string single-quoted-string" style="color:#e3116c">&#x27;login-page-url&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#e3116c">&#x27;login&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will be looking for (login.html or login.php or login.blade.php).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="refresh-token">Refresh Token<a href="#refresh-token" class="hash-link" aria-label="Direct link to Refresh Token" title="Direct link to Refresh Token">‚Äã</a></h2>
<p>In case your server is issuing a short-lived access tokens, the users will need to refresh their access tokens via the
refresh token that was provided to them when the access token was issued.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="refresh-token-with-proxy-for-first-party-clients">Refresh Token with proxy for first-party clients<a href="#refresh-token-with-proxy-for-first-party-clients" class="hash-link" aria-label="Direct link to Refresh Token with proxy for first-party clients" title="Direct link to Refresh Token with proxy for first-party clients">‚Äã</a></h3>
<p>By default, Apiato provide this endpoint <code>http://api.apiato.test/v1/clients/web/refresh</code> for the Web Client to be used
when you need to refresh the token for that client. You can of course create as many
endpoints as you want for each client. See the code of <code>app/Containers/AppSection/Authentication/UI/API/Routes/ProxyRefreshForWebClient.v1.public.php</code>
and create similar ones for each client. The most important change will be the <code>env(&#x27;CLIENT_WEB_ID&#x27;)</code> and
<code>env(&#x27;CLIENT_WEB_SECRET&#x27;),</code> passed to the <code>ProxyRefreshForWebClientAction</code>.</p>
<p>Those proxy refresh endpoints work in 2 ways. Either by passing the <code>refresh_token</code> manually to the endpoint. Or by
passing it with the HttpCookie. In both cases the code will work, and the server will reply with a response similar to this:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;token_type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Bearer&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;expires_in&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">31500</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;access_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tnJ1eXAiOiJKV1QiLCJhbGciOiJSUzI1Zx...&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;refresh_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ZFDPA1S7H8Wydjkjl+xt+hPGWTagX...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Containing new Access Token and new Refresh Token.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="refresh-token-without-proxy-for-first-party-or-third-party-clients">Refresh Token without proxy for first-party or third-party clients<a href="#refresh-token-without-proxy-for-first-party-or-third-party-clients" class="hash-link" aria-label="Direct link to Refresh Token without proxy for first-party or third-party clients" title="Direct link to Refresh Token without proxy for first-party or third-party clients">‚Äã</a></h3>
<p>The request to <code>http://api.apiato.test/v1/oauth/token</code> should contain <code>grant_type=refresh_token</code>, the <code>client_id</code> &amp;
<code>client_secret</code>, in addition to the <code>refresh_token</code> and finally the <code>scope</code> which could be empty.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="email-verification">Email Verification<a href="#email-verification" class="hash-link" aria-label="Direct link to Email Verification" title="Direct link to Email Verification">‚Äã</a></h2>
<p>Email verification is enabled by default but no route is protected against unconfirmed user access. To let only confirmed users
access a certain route you should add the <code>verified</code> middleware to that route. You can globally disable email verification by setting
<code>&#x27;require_email_verification&#x27; =&gt; false,</code> in <code>App\Containers\AppSection\Authentication\Configs\appSection-authentication.php</code>.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>While email verification is disabled you <strong>cannot</strong> protect any route against unconfirmed user access by using <code>verified</code> middleware and this
middleware is ignored.</p></div></div>
<p>When email verification is enabled and a user hits a protected endpoint, the API throws an exception, if the <code>User</code> is not yet <code>confirmed</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="process-flow">Process Flow<a href="#process-flow" class="hash-link" aria-label="Direct link to Process Flow" title="Direct link to Process Flow">‚Äã</a></h4>
<ol>
<li>Add your web app email verification redirect page url e.g. <code>http://myapp.com/email/verify</code> to the
<code>allowed-verify-email-urls</code> array of the <code>appSection-authentication</code> config.</li>
<li>Send the email verification url to the user by calling the <code>/email/verification-notification</code> endpoint using your web app and pass one of the valid urls that you added in step 1 into the <code>verification_url</code> field of the endpoint.</li>
<li>An email verification link will be sent to the user&#x27;s email which looks like this: <code>http://myapp.test/email/verify?url=http://api.myapi.test/v1/email/verify/XbPW7awNkzl83LD6/eaabd911e2e07ede6456d3bd5725c6d4a5c2dc0b?expires=1646913047&amp;signature=232702865b8353c445b39c50397e66db33c74df80e3db5a7c0d46ef94c8ab6a9</code></li>
<li>When the user click the link, he/she will be redirected to the url you specified before, in this case <code>http://myapp.com/email/verify</code> with the <code>url</code> query string</li>
<li><code>url</code> is the complete url your web app needs to call to verify the user. So you just call this url and the user will be verified.</li>
<li>At this point you should get a <code>200</code> OK response and the user&#x27;s email is verified.</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>If you are using a load balancer and having difficulty with the email verification link, e.g. app says the signature doesn&#x27;t match,
set the <code>protected $proxies = &#x27;*&#x27;</code> in the <code>App\Ship\Middlewares\TrustProxies.php</code> or update it to match your needs.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reset-password">Reset Password<a href="#reset-password" class="hash-link" aria-label="Direct link to Reset Password" title="Direct link to Reset Password">‚Äã</a></h2>
<p>Use the<br>
<code>/password/forgot</code> (<code>app/Containers/AppSection/User/UI/API/Routes/ForgotPassword.v1.public.php</code>)
and<br>
<code>/password/reset</code>  (<code>app/Containers/AppSection/User/UI/API/Routes/ResetPassword.v1.public.php</code>)  endpoints.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="process-flow-1">Process Flow<a href="#process-flow-1" class="hash-link" aria-label="Direct link to Process Flow" title="Direct link to Process Flow">‚Äã</a></h4>
<ol>
<li>
<p>Add your web app reset password page url e.g. <code>http://myapp.com/reset-password</code> to the
<code>allowed-reset-password-urls</code> array of the <code>appSection-authentication</code>config.</p>
</li>
<li>
<p>Call the <code>/password/forgot</code> endpoint with a <strong>reset url</strong> of your choice. It should be one of the urls in the <code>allowed-reset-password-urls</code> array.<br>
<!-- -->This endpoint will email user a link like this:<br>
<code>http://myapp.com/reset-password?email=mohammad.alavi1990@gmail.com&amp;token=51f8d80182f3785648c9b9dc7162719d158fc418b3cca86c14963638ec83d663</code></p>
</li>
<li>
<p>And when user click on that link it will go to your front end app reset password page. And then from there you should get
the user&#x27;s new password and call the <code>/password-reset</code> endpoint with all the required fields to reset the password.</p>
</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>You must set up the email to get this function to work, however for testing purposes set the <code>MAIL_MAILER=log</code> in
your <code>.env</code> file in order to the see the email content in the log file <code>storage/logs/laravel.log</code>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="social-authentication">Social Authentication<a href="#social-authentication" class="hash-link" aria-label="Direct link to Social Authentication" title="Direct link to Social Authentication">‚Äã</a></h2>
<p>For Social Authentication visit the <a href="/docs/11.x/additional-features/social-authentication">Social Authentication</a> page.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/apiato/documentation/tree/master/versioned_docs/version-11.x/core-features/authentication.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-08-24T13:25:26.000Z" itemprop="dateModified">Aug 24, 2024</time></b> by <b>Mohammad Alavi</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/11.x/core-features/code-generator"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Code Generator</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/11.x/core-features/authorization"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Authorization</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#api-authentication-oauth-20" class="table-of-contents__link toc-highlight">API Authentication (OAuth 2.0)</a></li><li><a href="#how-to-get-access-token-using-oauth-20" class="table-of-contents__link toc-highlight">How to get Access Token using OAuth 2.0</a></li><li><a href="#quick-overview" class="table-of-contents__link toc-highlight">Quick Overview</a></li><li><a href="#first-party-clients" class="table-of-contents__link toc-highlight">A: For first-party clients</a><ul><li><a href="#login-with-proxy-for-first-party-clients" class="table-of-contents__link toc-highlight">Login with Proxy for first-party clients</a></li><li><a href="#login-without-proxy-for-first-party-clients" class="table-of-contents__link toc-highlight">Login without Proxy for first-party clients</a></li></ul></li><li><a href="#third-party-clients" class="table-of-contents__link toc-highlight">B: For third-party clients</a><ul><li><a href="#login-without-proxy-for-third-party-clients" class="table-of-contents__link toc-highlight">Login without Proxy for third-party clients</a></li></ul></li><li><a href="#login-with-custom-attributes" class="table-of-contents__link toc-highlight">Login With Custom Attributes</a></li><li><a href="#logout" class="table-of-contents__link toc-highlight">Logout</a></li><li><a href="#responses" class="table-of-contents__link toc-highlight">Responses</a></li><li><a href="#change-tokens-expiration-dates" class="table-of-contents__link toc-highlight">Change Tokens Expiration dates</a></li><li><a href="#web-authentication" class="table-of-contents__link toc-highlight">Web Authentication</a></li><li><a href="#refresh-token" class="table-of-contents__link toc-highlight">Refresh Token</a><ul><li><a href="#refresh-token-with-proxy-for-first-party-clients" class="table-of-contents__link toc-highlight">Refresh Token with proxy for first-party clients</a></li><li><a href="#refresh-token-without-proxy-for-first-party-or-third-party-clients" class="table-of-contents__link toc-highlight">Refresh Token without proxy for first-party or third-party clients</a></li></ul></li><li><a href="#email-verification" class="table-of-contents__link toc-highlight">Email Verification</a></li><li><a href="#reset-password" class="table-of-contents__link toc-highlight">Reset Password</a></li><li><a href="#social-authentication" class="table-of-contents__link toc-highlight">Social Authentication</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2016 - 2024</div></div></div></footer></div>
</body>
</html>