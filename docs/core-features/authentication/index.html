<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.73">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apiato Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apiato Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-37514928-10","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Apiato" href="/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><title data-react-helmet="true">Authentication | Apiato</title><meta data-react-helmet="true" property="og:url" content="http://apiato.io//docs/core-features/authentication"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="9.x"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-9.x"><meta data-react-helmet="true" property="og:title" content="Authentication | Apiato"><meta data-react-helmet="true" name="description" content="- API Authentication (OAuth 2.0)"><meta data-react-helmet="true" property="og:description" content="- API Authentication (OAuth 2.0)"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="http://apiato.io//docs/core-features/authentication"><link data-react-helmet="true" rel="alternate" href="http://apiato.io//docs/core-features/authentication" hreflang="en"><link data-react-helmet="true" rel="alternate" href="http://apiato.io//docs/core-features/authentication" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.76447fe2.css">
<link rel="preload" href="/assets/js/styles.9fc356a5.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.edeb371b.js" as="script">
<link rel="preload" href="/assets/js/main.82482879.js" as="script">
<link rel="preload" href="/assets/js/1.fc584678.js" as="script">
<link rel="preload" href="/assets/js/2.53cdb25f.js" as="script">
<link rel="preload" href="/assets/js/3.faac18a9.js" as="script">
<link rel="preload" href="/assets/js/1be78505.b8d1b6be.js" as="script">
<link rel="preload" href="/assets/js/150.5421955d.js" as="script">
<link rel="preload" href="/assets/js/90c91afe.842db25d.js" as="script">
<link rel="preload" href="/assets/js/17896441.07213f2c.js" as="script">
<link rel="preload" href="/assets/js/e8ac06ec.e8924850.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Apiato Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.png" alt="Apiato Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Apiato</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/docs/">9.x</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/core-features/authentication">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/core-features/authentication">9.x</a></li></ul></div><a href="https://github.com/apiato/apiato" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Apiato Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.png" alt="Apiato Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Apiato</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/next/core-features/authentication">Next</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/core-features/authentication">9.x</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/apiato/apiato" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link"></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/requests">Requests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/responses">Responses</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/software-architectural-patterns">Software Architectural Patterns</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started/conventions-and-principles">Conventions and Principles</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Core Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/code-generator">Code Generator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/api-docs-generator">API Docs Generator</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/core-features/authentication">Authentication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/authorization">Authorization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/user-registration">User Registration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/social-authentication">Social Authentication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/query-parameters">Query Parameters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/default-endpoints">Default Endpoints</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/hash-id">Hash ID</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/localization">Localization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/rate-limiting">Rate Limiting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/requests-monitor">Requests Monitor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/data-caching">Data Caching</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/pagination">Pagination</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/payments">Payments</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/system-settings">System Settings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/api-versioning">API Versioning</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/validation">Validation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/search-query-parameter">Search Query Parameter</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/etag">ETag</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/useful-commands">Useful Commands</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/admin-dashboard">Admin Dashboard</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/core-features/profiler">Profiler</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Main Components</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/main-components/routes">Routes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/main-components/controllers">Controllers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/main-components/requests">Requests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/main-components/transporters">Transporters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/main-components/actions">Actions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/main-components/tasks">Tasks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/main-components/models">Models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/main-components/views">Views</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/main-components/transformers">Transformers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/main-components/subactions">Sub Actions</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Optional Components</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/providers">Providers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/repositories">Repositories</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/exceptions">Exceptions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/criterias">Criterias</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/tests">Tests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/migrations">Migrations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/seeders">Seeders</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/factories">Factories</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/middlewares">Middlewares</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/configs">Configs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/commands">Commands</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/jobs">Jobs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/languages">Languages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/events">Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/mails">Mails</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/notifications">Notifications</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optional-components/values">Values</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Miscellaneous</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/miscellaneous/magical-call">Magical Call</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/miscellaneous/tests-helpers">Tests Helpers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/miscellaneous/tasks-scheduling">Tasks Scheduling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/miscellaneous/tasks-queuing">Tasks Queuing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/miscellaneous/container-installer">Containers Installer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/miscellaneous/postman">Postman Environment</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/general/faq">Frequently Asked Questions</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/general/contribution-guide">Contribution Guide</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/general/upgrade-guide">Upgrade Guide</a></li><li class="menu__list-item"><a href="https://github.com/apiato/apiato/releases" target="_blank" rel="noopener noreferrer" class="menu__link menuLinkExternal_1OhN">Change Log</a></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" role="img" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div><span class="badge badge--secondary">Version: 9.x</span></div><header><h1 class="docTitle_3a4h">Authentication</h1></header><div class="markdown"><ul><li><a href="#api-authentication-oauth-20">API Authentication (OAuth 2.0)</a></li><li><a href="#how-to-get-access-token-using-oauth-20">How to get Access Token using OAuth 2.0</a></li><li><a href="#quick-overview">Quick Overview</a><ul><li><a href="#first-party-clients">A: For first-party clients</a><ul><li><a href="#login-with-proxy-for-first-party-clients">Login with Proxy for first-party clients</a></li><li><a href="#login-without-proxy-for-first-party-clients">Login without Proxy for first-party clients</a></li></ul></li><li><a href="#third-party-clients">B: For third-party clients</a><ul><li><a href="#login-without-proxy-for-third-party-clients">Login without Proxy for third-party clients</a></li></ul></li></ul></li><li><a href="#login-with-custom-attributes">Login With Custom Attributes</a></li><li><a href="#logout">Logout</a></li><li><a href="#responses">Responses</a></li><li><a href="#change-tokens-expiration-dates">Change Tokens Expiration dates</a></li><li><a href="#web-authentication">Web Authentication</a></li><li><a href="#refresh-token">Refresh Token</a><ul><li><a href="#refresh-token-with-proxy-for-first-party-clients">Refresh Token with proxy for first-party clients</a></li><li><a href="#refresh-token-without-proxy-for-first-party-or-third-party-clients">Refresh Token without proxy for first-party or third-party clients</a></li></ul></li><li><a href="#force-email-confirmation">Force Email Confirmation</a></li><li><a href="#reset-password">Reset Password</a></li><li><a href="#social-authentication">Social Authentication</a></li></ul><p>Middlewares are the best solution to apply Authentication in your App.</p><p>In Apiato you can use these two <code>Authentication Middlewares</code>, to protect your endpoints:</p><ul><li>API Authentication: <code>auth:api</code></li><li>Web Authentication: <code>auth:web</code></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="api-authentication-oauth-20"></a>API Authentication (OAuth 2.0)<a class="hash-link" href="#api-authentication-oauth-20" title="Direct link to heading">#</a></h2><p>To protect an <strong>API</strong> Endpoint from being accessible by unauthenticated users you can use the <code>auth:api</code> Middleware.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">&lt;?php</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">$router-&gt;get(&#x27;secret/info&#x27;, [</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    &#x27;uses&#x27;       =&gt; &#x27;Controller@getSecretInfo&#x27;,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    &#x27;middleware&#x27; =&gt; [</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        &#x27;auth:api&#x27;,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    ],</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">]);</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>All Endpoints protected with <code>auth:api</code> are accessible only when sending them a valid access token.</p><p>This Middleware is provided by the <a href="https://laravel.com/docs/passport" target="_blank" rel="noopener noreferrer">Laravel Passport</a> package. So you can read its
documentation for more details.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-get-access-token-using-oauth-20"></a>How to get Access Token using OAuth 2.0<a class="hash-link" href="#how-to-get-access-token-using-oauth-20" title="Direct link to heading">#</a></h2><p>1) Generate <code>client_id</code> &amp; <code>client_secret</code>. Continue reading below for details &quot;For first-party clients&quot;.</p><p>2) Use the generated client to call this oauth/token endpoint <code>http://api.apiato.test/v1/oauth/token</code></p><p>All the Auth Endpoints are documented. Go to <a href="/docs/core-features/api-docs-generator">Documentation Generator Page</a>
to see how you can generate the API documentation, and read them.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="quick-overview"></a>Quick Overview<a class="hash-link" href="#quick-overview" title="Direct link to heading">#</a></h2><p>OAuth lets you authenticate using different methods, these methods are called <code>grants</code>.
How to decide which grant type you should use! Check <a href="https://oauth2.thephpleague.com/authorization-server/which-grant/" target="_blank" rel="noopener noreferrer">this</a>,
and keep reading this documentation.</p><p><strong>Definitions:</strong></p><ul><li>The Client credentials: are the <code>client_id</code> &amp; <code>client_secret</code>.</li><li>The Proxy: is just an endpoint, that you should call instead of calling the Auth server endpoints directly, the proxy
endpoint will append the client credentials to your request and calls the Auth server for you, then return its response back. Each first-client app should have its own proxy endpoints (at least one of Login and one of Token Refresh). By default, Apiato provide an <code>Admin Web Client</code> endpoints.</li></ul><blockquote><p>You can Log in to the first party app with proxy or without proxy, while for the third party you only need to log in
without proxy. (same apply to refreshing token).</p><p>For first party apps:</p><ul><li>With Proxy &lt;&lt; best and easiest way, (requires manually generating clients creating proxy endpoints for each client)</li><li>Without Proxy &lt;&lt; if your frontend is not exposing the client credentials, you can call the Auth server endpoints directly without proxy.</li></ul><p>For third party apps:</p><ul><li>Without Proxy &lt;&lt; you don&#x27;t need a proxy for the third party clients as they usually integrate with your API from the backend side which protects the client credentials.</li></ul></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="first-party-clients"></a>A: For first-party clients<a class="hash-link" href="#first-party-clients" title="Direct link to heading">#</a></h2><p>First-party clients (Your Frontend Mobile, Web,... Apps) usually consumes your private API (Internal API).</p><p>For first-party clients you need to use the <strong>Resource owner credentials grant</strong> (A.K.A. Password Grant Tokens).</p><p>When this grant type is used, your server needs to authenticate the Client App first (ensuring the request is coming
from your trusted frontend App) and then needs to check if the user credentials are correct (ensuring the user is
registered and has the right access), before issuing an access token.</p><p><strong>Note:</strong></p><ul><li>On register: the API returns user data. You will need to log that user in (using the same credentials he passed) to
get his Access Token and make other API calls.</li><li>On login: the API returns the user Access Token with Refresh Token. You will need to request the User data by making
another call to the user endpoint, using his Access Token.</li></ul><p><strong>How it works:</strong></p><p>1) Create a password type Client in your database to represent one of your Apps (ex: Mobile App). Use
<code>php artisan passport:client --password</code> to generate the client.</p><p>2) After registration, the user can enter his (username + password) in your App login screen.</p><p>3) Your App should send a <strong>Post</strong> request to <code>http://api.apiato.test/v1/oauth/token</code> containing the user credentials
(<code>username</code> and <code>password</code>) and the client credentials (<code>client_id</code> and <code>client_secret</code>) in addition to the <code>scope</code>
and <code>grant_type=password</code>:</p><p><strong>Request:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token function" style="color:rgb(111, 66, 193)">curl</span><span class="token plain"> --request POST </span><span class="token punctuation" style="color:rgb(36, 41, 46)">\</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  --url http://api.apiato.test/v1/oauth/token </span><span class="token punctuation" style="color:rgb(36, 41, 46)">\</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  --header </span><span class="token string">&#x27;accept: application/json&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">\</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  --header </span><span class="token string">&#x27;content-type: application/x-www-form-urlencoded&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">\</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  --data </span><span class="token string">&#x27;username=admin%40admin.com&amp;password=admin&amp;client_id=2&amp;client_secret=SGUVv02b1ppQCgI7ZVeoTZDN6z8SSFLYiMOzzfiE&amp;grant_type=password&amp;scope=&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>Response:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;token_type&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;Bearer&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;expires_in&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(0, 92, 197)">31536000</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;access_token&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUz...&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;refresh_token&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;TPSPA1S6H8Wydjkjl+xt+hPGWTagL...&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>4) Your Client App should save the Tokens and start requesting secure data, by sending the Access Token in the HTTP
Header <code>Authorization = Bearer {Access-Token}</code>.</p><p>More info at <a href="https://laravel.com/docs/master/passport#password-grant-tokens" target="_blank" rel="noopener noreferrer">Laravel Passport Here</a></p><blockquote><p>WARNING: the Client ID and Secret should not be stored in JavaScript or browser cache, or made accessible in any way.</p></blockquote><p>So in case of Web Apps (JavaScript) you need to hide your client credentials behind a proxy. Apiato by default
provides you with a Login Proxy to use for all your trusted first party clients. We&#x27;ll see below how you can use them.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="login-with-proxy-for-first-party-clients"></a>Login with Proxy for first-party clients<a class="hash-link" href="#login-with-proxy-for-first-party-clients" title="Direct link to heading">#</a></h3><p>Concept: create an endpoint for each trusted client, to be used for a login.</p><p>Apiato by default has one url ready for your Web Admin Dashboard <code>clients/web/admin/login</code>. You can add more as you
need for each of your trusted first party clients Apps (example: <code>clients/web/users/login</code>, <code>clients/mobile/users/login</code>).</p><p>Behind the scene, that endpoint is appending the corresponding client ID and Secret to your request and making another
call to your Auth server with all the required data. <em>(this way the client does not need to send the ID and Secret with
the request, and he is using his own URL which gives even more control to which client is accessing your Server)</em>. Then
it returns the Auth response back to the client with the Tokens in it.</p><p>Note: You have to manually extract the Client credentials from the DB and put them in the <code>.env</code>, for each client.</p><p>When running <code>passport:install</code> it automatically creates one client for you with ID 2, so you can use that for your
first app. Or you can use <code>php artisan passport:client --password</code> to generate them.</p><p><code>.env</code> Example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">CLIENT_WEB_ADMIN_ID=2</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">CLIENT_WEB_ADMIN_SECRET=VkjYCUk5DUexJTE9yFAakytWCOqbShLgu9Ql67TI</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="login-without-proxy-for-first-party-clients"></a>Login without Proxy for first-party clients<a class="hash-link" href="#login-without-proxy-for-first-party-clients" title="Direct link to heading">#</a></h3><p>Login from your App by sending a POST request to <code>http://api.apiato.test/v1/oauth/token</code> with <code>grant_type=password</code>,
the User credentials (<code>username</code> &amp; <code>password</code>), Client Credentials (<code>client_id</code> &amp; <code>client_secret</code>) and finally the
<code>scope</code> which could be empty.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="third-party-clients"></a>B: For third-party clients<a class="hash-link" href="#third-party-clients" title="Direct link to heading">#</a></h2><p>Third party clients (User&#x27;s custom external Apps, who wants to integrate with your Software) always consumes your
public API (External API) only.</p><p>For third-party clients you need to use the <strong>Client credentials grant</strong> (A.K.A. Personal Access Tokens). <em>This grant
type is the simplest and is suitable for machine-to-machine authentication.</em></p><p>With this grant type your server needs to authenticate the Client App only, before issuing an access token.</p><p><strong>How it works</strong></p><p>1) User logs in to your Clients App Interface (an external App made for your users only), go to settings, create Client
(of type <code>personal</code>) and copy the ID and Secret. <em>(Note this can be done via an API if you prefer)</em></p><p>You may generate a personal client for testing purposes using <code>php artisan passport:client --personal</code>.</p><p>2) User add the Client credentials to his &quot;Server Side software&quot; and send a <strong>Post</strong> request to
<code>http://api.apiato.test/v1/oauth/token</code> containing the Client credentials (<code>client_id</code> and <code>client_secret</code>) in
addition to the <code>scope</code> and <code>grant_type=client_credentials</code>:</p><p>Request:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><div tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token function" style="color:rgb(111, 66, 193)">curl</span><span class="token plain"> --request POST </span><span class="token punctuation" style="color:rgb(36, 41, 46)">\</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  --url http://api.apiato.test/v1/oauth/token </span><span class="token punctuation" style="color:rgb(36, 41, 46)">\</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  --header </span><span class="token string">&#x27;accept: application/json&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">\</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  --header </span><span class="token string">&#x27;content-type: application/x-www-form-urlencoded&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">\</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  --data </span><span class="token string">&#x27;client_id=1&amp;client_secret=y1RbtnOvh9rpA91zPI2tiVKmFlepNy9dhHkzUKle&amp;grant_type=client_credentials&amp;scope=&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Response:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;token_type&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;Bearer&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;expires_in&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(0, 92, 197)">31536000</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;access_token&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1Ni...&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;refresh_token&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;ZFDPA1S7H8Wydjkjl+xt+hPGWTagX...&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>3) The Client will be granted an Access Token to be saved. Then the Client can start requesting secure data, by sending
the Access Token in the HTTP Header <code>Authorization = Bearer {Access-Token}</code>.</p><p>Note: When a new user is registered, will be issued a personal Access Token automatically. Check the User
&quot;Registration page&quot;.</p><p>More info at <a href="https://laravel.com/docs/master/passport#personal-access-tokens" target="_blank" rel="noopener noreferrer">Laravel Passport Here</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="login-without-proxy-for-third-party-clients"></a>Login without Proxy for third-party clients<a class="hash-link" href="#login-without-proxy-for-third-party-clients" title="Direct link to heading">#</a></h3><p>We usually do not need a proxy for third-party clients as they are most likely making calls form their servers, thus
the Client ID and Secret should be secure and not exposed to the users.</p><p>Login by sending a POST request to <code>http://api.apiato.test/v1/oauth/token</code> with <code>grant_type=client_credentials</code>,
Client Credentials (<code>client_id</code> &amp; <code>client_secret</code>) and finally the <code>scope</code> which could be empty.</p><p>Once issued, you can use that Access Token to make requests to protected resources (Endpoints).
The Access Token should be sent in the <code>Authorization</code> header of type <code>Bearer</code>
(Example: <code>Authorization = Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUz...</code>)</p><p><strong>Keep in mind there&#x27;s no session state when using Tokens for Authentication</strong></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="login-with-custom-attributes"></a>Login With Custom Attributes<a class="hash-link" href="#login-with-custom-attributes" title="Direct link to heading">#</a></h2><blockquote><p>This feature is supported with Apiato 7.4.</p></blockquote><p>By default, Apiato allows <code>User</code>s to log in with their <code>email</code> address. However, you may want to also allow <code>username</code>
and <code>phone</code> to login your users.</p><p>Here is, how to configure and use this feature.</p><ul><li>You may need to adapt your database accordingly (e.g., add the respective field to the <code>users</code> table).</li><li>You may need to adapt the <code>Task</code> that <code>create</code> a <code>User</code> object (e.g., the <code>CreateUserByCredentialsTask</code>) accordingly
to support the new fields. This may also affect your <code>Register</code> logic.</li><li>Check the <code>App\Containers\Authentication\Configs\authentication-container</code> Configuration file and check the <code>login</code>
params in order to configure this feature.</li><li>Adapt the <code>ProxyApiLoginTransporter</code> accordingly to support your new Login Fields. These fields need to be added
to <code>properties</code></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="logout"></a>Logout<a class="hash-link" href="#logout" title="Direct link to heading">#</a></h2><p>Logout by sending a <code>DELETE</code> request to <code>http://api.apiato.test/v1/logout/</code> containing the Token in the Header.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;message&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;Token revoked successfully.&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="responses"></a>Responses<a class="hash-link" href="#responses" title="Direct link to heading">#</a></h2><p><strong>Authentication failed JSON response:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;errors&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;Missing or invalid Access Token!&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;status_code&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(0, 92, 197)">403</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;message&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;Unauthenticated.&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>Wrong Client ID or Secret:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;error&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;invalid_client&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;message&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;Client authentication failed&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>Access Correct:</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;token_type&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;Bearer&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;expires_in&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(0, 92, 197)">31500</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;access_token&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;tnJ1eXAiOiJKV1QiLCJhbGciOiJSUzI1Zx...&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;refresh_token&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;ZFDPA1S7H8Wydjkjl+xt+hPGWTagX...&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="change-tokens-expiration-dates"></a>Change Tokens Expiration dates<a class="hash-link" href="#change-tokens-expiration-dates" title="Direct link to heading">#</a></h2><p>Go to <code>app/Ship/Configs/apiato.php</code> config file and edit this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">&lt;?php</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">/*</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|--------------------------------------------------------------------------</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">| Access Token Expiration</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|--------------------------------------------------------------------------</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">| In Days. Default to 3650 days = 10 years</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">*/</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">&#x27;expires-in&#x27; =&gt; env(&#x27;API_TOKEN_EXPIRES&#x27;, 3650),</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">/*</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|--------------------------------------------------------------------------</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">| Refresh Token Expiration</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|--------------------------------------------------------------------------</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">| In Days. Default to 3650 days = 10 years</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">*/</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">&#x27;refresh-expires-in&#x27; =&gt; env(&#x27;API_REFRESH_TOKEN_EXPIRES&#x27;, 3650),</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To change from days to minutes you need to edit the <code>boot</code> function in <code>App\Containers\Authentication\Providers\AuthProvider</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="web-authentication"></a>Web Authentication<a class="hash-link" href="#web-authentication" title="Direct link to heading">#</a></h2><p>To protect an <strong>Web</strong> Endpoint from being accessible by unauthenticated users you can use the <code>auth:web</code> Middleware.</p><p>Example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">&lt;?php</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">$router-&gt;get(&#x27;private/page&#x27;, [</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    &#x27;uses&#x27;       =&gt; &#x27;Controller@showPrivatePage&#x27;,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    &#x27;middleware&#x27; =&gt; [</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        &#x27;auth:web&#x27;,</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    ],</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">]);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This Middleware is provided by apiato and is different from the default Laravel Auth Middleware.</p><p><strong>If authentication failed, users will be redirected to a login page</strong></p><p>To change the login page view go to the config file <code>app/Ship/Configs/apiato.php</code>, and set the name of your login page there as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">&lt;?php</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">/*</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|--------------------------------------------------------------------------</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">| The Login Page URL</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">|--------------------------------------------------------------------------</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">*/</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">&#x27;login-page-url&#x27; =&gt; &#x27;login&#x27;,</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This will be looking for (login.html or login.php or login.blade.php).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="refresh-token"></a>Refresh Token<a class="hash-link" href="#refresh-token" title="Direct link to heading">#</a></h2><p>In case your server is issuing a short-lived access tokens, the users will need to refresh their access tokens via the
refresh token that was provided to them when the access token was issued.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="refresh-token-with-proxy-for-first-party-clients"></a>Refresh Token with proxy for first-party clients<a class="hash-link" href="#refresh-token-with-proxy-for-first-party-clients" title="Direct link to heading">#</a></h3><p>By default, Apiato provide this ready endpoint <code>http://api.apiato.test/v1/clients/web/admin/refresh</code> for the Web
Admin Dashboard Client  to be used when you need to refresh token for that client. You can of course create as many
other endpoints as you want for each client. See the code of (<code>app/Containers/Authentication/UI/API/Routes/ProxyRefreshForAdminWebClient.v1.public.php</code>)
and create similar one for each client. The most important change will be the <code>env(&#x27;CLIENT_WEB_ADMIN_ID&#x27;)</code> and
<code>env(&#x27;CLIENT_WEB_ADMIN_SECRET&#x27;),</code> passed to the <code>ProxyApiRefreshAction</code>.</p><p>Those proxy refresh endpoints work in 2 ways. Either by passing the <code>refresh_token</code> manually to the endpoint. Or by
passing it with the HttpCookie. In both cases the code will work, and the server will reply with a response similar to this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly json"><div tabindex="0" class="prism-code language-json codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;token_type&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;Bearer&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;expires_in&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(0, 92, 197)">31500</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;access_token&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;tnJ1eXAiOiJKV1QiLCJhbGciOiJSUzI1Zx...&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;refresh_token&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;ZFDPA1S7H8Wydjkjl+xt+hPGWTagX...&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Containing new Access Token and new Refresh Token.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="refresh-token-without-proxy-for-first-party-or-third-party-clients"></a>Refresh Token without proxy for first-party or third-party clients<a class="hash-link" href="#refresh-token-without-proxy-for-first-party-or-third-party-clients" title="Direct link to heading">#</a></h3><p>The request to <code>http://api.apiato.test/v1/oauth/token</code> should contain <code>grant_type=refresh_token</code>, the <code>client_id</code> &amp;
<code>client_secret</code>, in addition to the <code>refresh_token</code> and finally the <code>scope</code> which could be empty.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="force-email-confirmation"></a>Force Email Confirmation<a class="hash-link" href="#force-email-confirmation" title="Direct link to heading">#</a></h2><p>By default, a user does not have to confirm his email address to be able to login.
However, to force users to confirm their email (prevent unconfirmed users from accessing the site), you can set
<code>&#x27;require_email_confirmation&#x27; =&gt; true,</code> in <code>App\Containers\Authentication\Configs\authentication.php</code>.</p><p>When email confirmation is enabled (value set to <code>true</code>), the API throws an exception, if the <code>User</code> is not yet <code>confirmed</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="reset-password"></a>Reset Password<a class="hash-link" href="#reset-password" title="Direct link to heading">#</a></h2><p>Use the <code>/password-forgot</code> (<code>app/Containers/User/UI/API/Routes/ForgotPassword.v1.public.php</code>)
and <code>/password-reset</code>  (<code>app/Containers/User/UI/API/Routes/ResetPassword.v1.public.php</code>)  endpoints.</p><p>First you need to send a request to the <code>/password-forgot</code> endpoint.
It will send you an email with a link when you make a request to that link, it will call the <code>/password-reset</code> endpoint.</p><p>Note: For security reason, make sure the reset password URL is set in <code>app/Containers/User/Configs/user-container.php</code>,
and given to the client App, to be sent as parameter when calling the <code>/password-forgot</code>.</p><p>Note: You must set up the email to get this function to work, however for testing purposes set the <code>MAIL_DRIVER=log</code> in
your <code>.env</code> file in order to the see the email content in the log file <code>laravel.log</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="social-authentication"></a>Social Authentication<a class="hash-link" href="#social-authentication" title="Direct link to heading">#</a></h2><p>For Social Authentication visit the <a href="/docs/core-features/social-authentication">Social Authentication</a> page.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/apiato/documentation/tree/master/versioned_docs/version-9.x/core-features/authentication.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-04-18T13:15:00.000Z" class="lastUpdatedDate_1WI_">4/18/2021</time> by <strong>Moslem Deris</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/core-features/api-docs-generator"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« API Docs Generator</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/core-features/authorization"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Authorization Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#api-authentication-oauth-20" class="table-of-contents__link">API Authentication (OAuth 2.0)</a></li><li><a href="#how-to-get-access-token-using-oauth-20" class="table-of-contents__link">How to get Access Token using OAuth 2.0</a></li><li><a href="#quick-overview" class="table-of-contents__link">Quick Overview</a></li><li><a href="#first-party-clients" class="table-of-contents__link">A: For first-party clients</a><ul><li><a href="#login-with-proxy-for-first-party-clients" class="table-of-contents__link">Login with Proxy for first-party clients</a></li><li><a href="#login-without-proxy-for-first-party-clients" class="table-of-contents__link">Login without Proxy for first-party clients</a></li></ul></li><li><a href="#third-party-clients" class="table-of-contents__link">B: For third-party clients</a><ul><li><a href="#login-without-proxy-for-third-party-clients" class="table-of-contents__link">Login without Proxy for third-party clients</a></li></ul></li><li><a href="#login-with-custom-attributes" class="table-of-contents__link">Login With Custom Attributes</a></li><li><a href="#logout" class="table-of-contents__link">Logout</a></li><li><a href="#responses" class="table-of-contents__link">Responses</a></li><li><a href="#change-tokens-expiration-dates" class="table-of-contents__link">Change Tokens Expiration dates</a></li><li><a href="#web-authentication" class="table-of-contents__link">Web Authentication</a></li><li><a href="#refresh-token" class="table-of-contents__link">Refresh Token</a><ul><li><a href="#refresh-token-with-proxy-for-first-party-clients" class="table-of-contents__link">Refresh Token with proxy for first-party clients</a></li><li><a href="#refresh-token-without-proxy-for-first-party-or-third-party-clients" class="table-of-contents__link">Refresh Token without proxy for first-party or third-party clients</a></li></ul></li><li><a href="#force-email-confirmation" class="table-of-contents__link">Force Email Confirmation</a></li><li><a href="#reset-password" class="table-of-contents__link">Reset Password</a></li><li><a href="#social-authentication" class="table-of-contents__link">Social Authentication</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs">Getting Started</a></li><li class="footer__item"><a href="https://github.com/Mahmoudz/Porto#porto-software-architectural-pattern" target="_blank" rel="noopener noreferrer" class="footer__link-item">Porto Architecture</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/ryPcV4KM5k" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord Server</a></li><li class="footer__item"><a href="https://github.com/apiato/apiato/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Issues</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Contributors</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/general/contribution-guide">Contribution Guide</a></li><li class="footer__item"><a href="https://github.com/apiato/apiato/blob/9.0/CODE_OF_CONDUCT.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Code of Conduct</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Sponsors</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/apiato/apiato#sponsors" target="_blank" rel="noopener noreferrer" class="footer__link-item">Our Sponsors</a></li><li class="footer__item"><a href="https://opencollective.com/apiato" target="_blank" rel="noopener noreferrer" class="footer__link-item">Become a Sponsor</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2016 - 2021</div></div></div></footer></div>
<script src="/assets/js/styles.9fc356a5.js"></script>
<script src="/assets/js/runtime~main.edeb371b.js"></script>
<script src="/assets/js/main.82482879.js"></script>
<script src="/assets/js/1.fc584678.js"></script>
<script src="/assets/js/2.53cdb25f.js"></script>
<script src="/assets/js/3.faac18a9.js"></script>
<script src="/assets/js/1be78505.b8d1b6be.js"></script>
<script src="/assets/js/150.5421955d.js"></script>
<script src="/assets/js/90c91afe.842db25d.js"></script>
<script src="/assets/js/17896441.07213f2c.js"></script>
<script src="/assets/js/e8ac06ec.e8924850.js"></script>
</body>
</html>