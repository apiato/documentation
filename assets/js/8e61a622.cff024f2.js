"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[2818],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),l=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=l(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,d=p(e,["components","mdxType","originalType","parentName"]),u=l(n),m=i,h=u["".concat(s,".").concat(m)]||u[m]||c[m]||o;return n?a.createElement(h,r(r({ref:t},d),{},{components:n})):a.createElement(h,r({ref:t},d))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=m;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p[u]="string"==typeof e?e:i,r[1]=p;for(var l=2;l<o;l++)r[l]=n[l];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},31457:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>c,frontMatter:()=>o,metadata:()=>p,toc:()=>l});var a=n(87462),i=(n(67294),n(3905));const o={sidebar_position:1,title:"Repositories",tags:["component","optional-component","repository","criteria","action","task"]},r=void 0,p={unversionedId:"components/optional-components/repository/repositories",id:"version-12.x/components/optional-components/repository/repositories",title:"Repositories",description:"Apiato provides a powerful repository pattern implementation based on the L5 Repository package.",source:"@site/versioned_docs/version-12.x/components/optional-components/repository/repositories.md",sourceDirName:"components/optional-components/repository",slug:"/components/optional-components/repository/repositories",permalink:"/docs/components/optional-components/repository/repositories",draft:!1,editUrl:"https://github.com/apiato/documentation/tree/master/versioned_docs/version-12.x/components/optional-components/repository/repositories.md",tags:[{label:"component",permalink:"/docs/tags/component"},{label:"optional-component",permalink:"/docs/tags/optional-component"},{label:"repository",permalink:"/docs/tags/repository"},{label:"criteria",permalink:"/docs/tags/criteria"},{label:"action",permalink:"/docs/tags/action"},{label:"task",permalink:"/docs/tags/task"}],version:"12.x",lastUpdatedBy:"Mohammad Alavi",lastUpdatedAt:1697511591,formattedLastUpdatedAt:"Oct 17, 2023",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Repositories",tags:["component","optional-component","repository","criteria","action","task"]},sidebar:"tutorialSidebar",previous:{title:"Policies",permalink:"/docs/components/optional-components/policies"},next:{title:"Criterias",permalink:"/docs/components/optional-components/repository/criterias"}},s={},l=[{value:"Rules",id:"rules",level:2},{value:"Folder Structure",id:"folder-structure",level:2},{value:"Code Example",id:"code-example",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Linking Repositories &amp; Models",id:"linking-repositories--models",level:2},{value:"Repositories &amp; Models Auto-Linking",id:"repositories--models-auto-linking",level:3},{value:"Pagination",id:"pagination",level:2},{value:"Setting Pagination Limits",id:"setting-pagination-limits",level:3},{value:"Disabling Pagination",id:"disabling-pagination",level:3},{value:"Project-Wide",id:"project-wide",level:4},{value:"Per Repository",id:"per-repository",level:4},{value:"RequestCriteria",id:"requestcriteria",level:2},{value:"Sorting &amp; Ordering",id:"sorting--ordering",level:3},{value:"Searching",id:"searching",level:3},{value:"Searching with Hashed IDs",id:"searching-with-hashed-ids",level:4},{value:"Filtering",id:"filtering",level:3},{value:"Caching",id:"caching",level:2},{value:"Skipping Cache",id:"skipping-cache",level:3}],d={toc:l},u="wrapper";function c(e){let{components:t,...n}=e;return(0,i.kt)(u,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Apiato provides a powerful repository pattern implementation based on the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/andersao/l5-repository"},"L5 Repository")," package."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"To prevent overlap with the L5 Repository documentation, this page\nexclusively delves into Apiato distinct features and configurations,\noffering only a limited set of examples.\nTo learn more about the L5 Repository package,\nplease refer to its ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/andersao/l5-repository"},"documentation"),".")),(0,i.kt)("p",null,"Repositories play a crucial role in software architecture\nby separating and abstracting the data layer from the business logic.\nThey serve as an essential architectural pattern to promote code separation,\nflexibility, and maintainability in software development.\nRepositories help\ncreate clean and organized codebases\nby abstracting the intricacies of data access and manipulation from the core business logic."),(0,i.kt)("p",null,"To generate new repositories\nyou may use the ",(0,i.kt)("inlineCode",{parentName:"p"},"apiato:generate:repository")," interactive command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"php artisan apiato:generate:repository\n")),(0,i.kt)("p",null,"You can also generate a model and its repository at the same time by using the ",(0,i.kt)("inlineCode",{parentName:"p"},"apiato:generate:model")," interactive command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"php artisan apiato:generate:model\n")),(0,i.kt)("h2",{id:"rules"},"Rules"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"All Repositories:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"MUST be placed in the ",(0,i.kt)("inlineCode",{parentName:"li"},"app/Containers/{section}/{container}/Data/Repositories")," directory."),(0,i.kt)("li",{parentName:"ul"},"MUST extend the ",(0,i.kt)("inlineCode",{parentName:"li"},"App\\Ship\\Parents\\Repositories\\Repository")," class.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"The parent extension SHOULD be aliased as ",(0,i.kt)("inlineCode",{parentName:"li"},"ParentRepository"),"."))),(0,i.kt)("li",{parentName:"ul"},"SHOULD be named after the model they are associated with, followed by the ",(0,i.kt)("inlineCode",{parentName:"li"},"Repository")," suffix. For instance, ",(0,i.kt)("inlineCode",{parentName:"li"},"UserRepository.php"),"."))),(0,i.kt)("li",{parentName:"ul"},"A Model MUST always get accessed through its Repository."),(0,i.kt)("li",{parentName:"ul"},"Every Model MUST have a Repository.")),(0,i.kt)("h2",{id:"folder-structure"},"Folder Structure"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-markdown"},"app\n\u2514\u2500\u2500 Containers\n    \u2514\u2500\u2500 Section\n        \u2514\u2500\u2500 Container\n            \u2514\u2500\u2500 Data\n                \u2514\u2500\u2500 Repositories\n                    \u251c\u2500\u2500 UserRepository.php\n                    \u2514\u2500\u2500 ...\n")),(0,i.kt)("h2",{id:"code-example"},"Code Example"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"use App\\Ship\\Parents\\Repositories\\Repository as ParentRepository;\n\nclass UserRepository extends ParentRepository\n{\n    protected $fieldSearchable = [\n        'id' => '=',\n        'name' => 'like',\n        'email' => '=',\n        'email_verified_at' => '=',\n        'created_at' => '=',\n    ];\n}\n")),(0,i.kt)("h2",{id:"configuration"},"Configuration"),(0,i.kt)("p",null,"All the configuration options for the this feature are located in the ",(0,i.kt)("inlineCode",{parentName:"p"},"app/Ship/Configs/repository.php")," config file."),(0,i.kt)("h2",{id:"linking-repositories--models"},"Linking Repositories & Models"),(0,i.kt)("p",null,"Once you have created a repository, you need to link it to its corresponding model.\nIf you have followed the repository naming ",(0,i.kt)("a",{parentName:"p",href:"#rules"},"rules")," outlined above,\nApiato will automatically link your repositories to their corresponding models."),(0,i.kt)("p",null,"However, if you have not followed the rules, and your repository name differs from the model name,\nyou must implement the ",(0,i.kt)("inlineCode",{parentName:"p"},"model")," method in the repository."),(0,i.kt)("p",null,"This method allows you to specify the correct model class that should be used for the repository operations."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"use App\\Ship\\Parents\\Repositories\\Repository as ParentRepository;\n\nclass DemoRepository extends ParentRepository\n{\n    // ...\n    \n    public function model(): string\n    {\n        return AnotherDemo::class;\n    }\n}\n")),(0,i.kt)("h3",{id:"repositories--models-auto-linking"},"Repositories & Models Auto-Linking"),(0,i.kt)("p",null,"Apiato offers a repository auto-linking feature that eliminates the need for manual linking of repositories & models.\nThis automatic linking process relies on adhering to standard Apiato naming conventions for repositories."),(0,i.kt)("p",null,"By following the repository naming ",(0,i.kt)("a",{parentName:"p",href:"#rules"},"rules")," outlined above,\nyou allow Apiato to automatically link your repositories to their corresponding models."),(0,i.kt)("p",null,"To summarize:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Repositories must be stored within the ",(0,i.kt)("inlineCode",{parentName:"li"},"app/Containers/{section}/{container}/Data/Repositories")," directory."),(0,i.kt)("li",{parentName:"ul"},"The repository name should mirror the corresponding model's name while appending a ",(0,i.kt)("inlineCode",{parentName:"li"},"Repository")," suffix. For instance, a ",(0,i.kt)("inlineCode",{parentName:"li"},"User")," model corresponds to a ",(0,i.kt)("inlineCode",{parentName:"li"},"UserRepository")," repository class.")),(0,i.kt)("h2",{id:"pagination"},"Pagination"),(0,i.kt)("p",null,"Pagination is automatically applied when you use the ",(0,i.kt)("inlineCode",{parentName:"p"},"paginate")," method with a model repository:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"{\n    $this->userRepository->paginate();\n}\n")),(0,i.kt)("p",null,"To move between pages of results, you can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"page")," query parameter like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"api.apiato.test/v1/users?page=200\n")),(0,i.kt)("p",null,"You can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"page")," parameter in any ",(0,i.kt)("inlineCode",{parentName:"p"},"GET")," request that lists records."),(0,i.kt)("p",null,"Whenever a request returns paginated results,\nyou'll find information about the pagination in the ",(0,i.kt)("strong",{parentName:"p"},"meta")," section of the response,\nwhich tells you things like the total number of records, the number on the current page, and more."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'"data": [...],\n"meta": {\n    "pagination": {\n        "total": 2000,\n        "count": 30,\n        "per_page": 10,\n        "current_page": 20,\n        "total_pages": 200,\n        "links": []\n    }\n}\n')),(0,i.kt)("h3",{id:"setting-pagination-limits"},"Setting Pagination Limits"),(0,i.kt)("p",null,"You can control the number of results displayed on a single page using the ",(0,i.kt)("inlineCode",{parentName:"p"},"limit")," parameter."),(0,i.kt)("p",null,"By default, the pagination limit is set to 10.\nIf you don't specify the ",(0,i.kt)("inlineCode",{parentName:"p"},"?limit=")," parameter in your request, the response will contain 10 records per page."),(0,i.kt)("p",null,"You can adjust the default pagination limit in the ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dotenv"},"PAGINATION_LIMIT_DEFAULT=10\n")),(0,i.kt)("p",null,"For instance, if you want to receive 100 resources per page, add the ",(0,i.kt)("inlineCode",{parentName:"p"},"?limit=100")," query parameter to your request:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"api.apiato.test/v1/users?limit=100\n")),(0,i.kt)("p",null,"This will return 100 resources within a single page of results.\nYou can also combine the ",(0,i.kt)("inlineCode",{parentName:"p"},"limit")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"page")," query parameters to access the next 100 resources:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"api.apiato.test/v1/users?limit=100&page=2\n")),(0,i.kt)("h3",{id:"disabling-pagination"},"Disabling Pagination"),(0,i.kt)("p",null,"You can allow clients to request all data that matches their criteria and disable pagination,\nwhich can be applied either project-wide or on a per-repository basis.\nThis enables a request to retrieve all matching data by specifying ",(0,i.kt)("inlineCode",{parentName:"p"},"limit=0"),"."),(0,i.kt)("p",null,"To retrieve all matching entities in a single page, you can use the following query parameter:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"api.apiato.test/v1/users?limit=0\n")),(0,i.kt)("h4",{id:"project-wide"},"Project-Wide"),(0,i.kt)("p",null,"To allow disabling pagination for the entire project, set ",(0,i.kt)("inlineCode",{parentName:"p"},"PAGINATION_SKIP=true")," in the ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file."),(0,i.kt)("h4",{id:"per-repository"},"Per Repository"),(0,i.kt)("p",null,"If you wish to allow disabling pagination for a specific repository,\nset the ",(0,i.kt)("inlineCode",{parentName:"p"},"$allowDisablePagination")," property in your repository class."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Per-repository configurations take precedence and override the global settings.")),(0,i.kt)("h2",{id:"requestcriteria"},"RequestCriteria"),(0,i.kt)("p",null,"RequestCriteria is a standard Criteria implementation\nthat enables filters to be applied to the repository based on parameters sent in the request.\nIt allows for dynamic searches, data filtering, and query customization."),(0,i.kt)("p",null,"To utilize RequestCriteria, you need to apply it to the repository.\nApiato provides two methods, ",(0,i.kt)("inlineCode",{parentName:"p"},"addRequestCriteria")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"removeRequestCriteria"),", which are available on all repositories."),(0,i.kt)("p",null,"Here's an example of how to use RequestCriteria:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"use App\\Containers\\AppSection\\User\\Data\\Repositories\\UserRepository;\nuse App\\Ship\\Parents\\Tasks\\Task as ParentTask;\n\nclass GetAllUsersTask extends ParentTask\n{\n    public function __construct(\n        protected readonly UserRepository $repository\n    ) {\n    }\n\n    public function run(): mixed\n    {\n        // $this->repository->removeRequestCriteria();\n        return $this->repository->addRequestCriteria()->paginate();\n    }\n}\n")),(0,i.kt)("p",null,"It's important to note\nthat using the ",(0,i.kt)("inlineCode",{parentName:"p"},"removeRequestCriteria")," method is only relevant if you have previously applied ",(0,i.kt)("inlineCode",{parentName:"p"},"RequestCriteria"),".\nIf it hasn't been applied, there is no need to remove it,\nas RequestCriteria is not automatically applied unless explicitly used."),(0,i.kt)("h3",{id:"sorting--ordering"},"Sorting & Ordering"),(0,i.kt)("p",null,"You can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"orderBy")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"sortedBy")," parameters to sort the data in the response."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"sortedBy")," parameter is typically employed in conjunction with the ",(0,i.kt)("inlineCode",{parentName:"p"},"orderBy")," parameter."),(0,i.kt)("p",null,"By default, the ",(0,i.kt)("inlineCode",{parentName:"p"},"orderBy")," parameter sorts the data in ",(0,i.kt)("strong",{parentName:"p"},"Ascending")," order.\nTo sort the data in ",(0,i.kt)("strong",{parentName:"p"},"Descending")," order, you can include ",(0,i.kt)("inlineCode",{parentName:"p"},"sortedBy=desc"),"."),(0,i.kt)("p",null,"For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"?orderBy=id&sortedBy=asc\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"?orderBy=created_at&sortedBy=desc\n?orderBy=name&sortedBy=asc\n")),(0,i.kt)("p",null,"You can use the following values for the ",(0,i.kt)("inlineCode",{parentName:"p"},"sortedBy")," parameter:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"asc")," for Ascending."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"desc")," for Descending.")),(0,i.kt)("h3",{id:"searching"},"Searching"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"There is much more to searching than what is covered here.\nPlease refer to the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/andersao/l5-repository"},"L5 Repository documentation")," for more details.")),(0,i.kt)("p",null,"When the RequestCriteria is enabled for a specific route,\nyou can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"search")," parameter in ",(0,i.kt)("inlineCode",{parentName:"p"},"GET")," HTTP requests on that route to perform searches."),(0,i.kt)("p",null,"To make the search feature work, you need to specify which fields from the model should be searchable.\nIn your repository,\nset the ",(0,i.kt)("inlineCode",{parentName:"p"},"fieldSearchable")," field with the names of the fields\nyou want to make searchable or specify a relation to the fields."),(0,i.kt)("p",null,"Here's an example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"protected $fieldSearchable = [\n    'name',\n    'email',\n    'product.name'\n];\n")),(0,i.kt)("p",null,'You can also set the type of condition that will be used to perform the query. The default condition is "=":'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"protected $fieldSearchable = [\n    'name' => 'like',\n    'email', // Default Condition \"=\"\n    'your_field' => 'condition'\n];\n")),(0,i.kt)("p",null,"You can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"search")," parameter in various ways:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"?search=John\n?search=name:John\n?search=name:John%20Doe\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Replace spaces with ",(0,i.kt)("inlineCode",{parentName:"p"},"%20")," in the URL (e.g., ",(0,i.kt)("inlineCode",{parentName:"p"},"search=keyword%20here"),").")),(0,i.kt)("h4",{id:"searching-with-hashed-ids"},"Searching with Hashed IDs"),(0,i.kt)("p",null,"If you have ",(0,i.kt)("a",{parentName:"p",href:"/docs/security/hash-id"},"Hash ID")," enabled and want to search a hashed field,\nlike a user ID, you need to instruct the ",(0,i.kt)("inlineCode",{parentName:"p"},"RequestCriteria")," to decode it before performing the search."),(0,i.kt)("p",null,"For example,\nif you have a search query like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"`?search=id:XbPW7awNkzl83LD6;parent_id:aYOxlpzRMwrX3gD7;some_hashed_id:NxOpZowo9GmjKqdR`\n")),(0,i.kt)("p",null,"You should update your ",(0,i.kt)("inlineCode",{parentName:"p"},"addRequestCriteria")," method as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"$this->repository->addRequestCriteria(['id', 'parent_id', 'some_hashed_id'])->all();\n")),(0,i.kt)("h3",{id:"filtering"},"Filtering"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"filter")," parameter can be used in any HTTP request to control the response size by specifying the data you want in the response."),(0,i.kt)("p",null,"For example, to retrieve only the ",(0,i.kt)("inlineCode",{parentName:"p"},"id")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"status")," fields from a Model, you can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"filter")," parameter like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"api.apiato.test/v1/users?filter=id;status\n")),(0,i.kt)("p",null,"The response will include only the specified fields, as shown in the example response:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "data": [\n    {\n      "id": "0one37vjk49rp5ym",\n      "status": "approved"\n    }\n  ]\n}\n')),(0,i.kt)("p",null,"It's important to note that the transformer used to format the data is also filtered.\nThis means that only the fields specified in the filter are present, and all other fields are excluded.\nThis filtering also applies to all ",(0,i.kt)("a",{parentName:"p",href:"/docs/components/main-components/transformers#including-relationships"},"included relationships")," of the object."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "data": [\n    {\n      "id": "0one37vjk49rp5ym",\n      "status": "approved",\n      "products": {\n        "data": [\n          {\n            "id": "bmo7y84xpgeza06k",\n            "status": "pending"\n          },\n          {\n            "id": "o0wzxbg0q4k7jp9d",\n            "status": "fulfilled"\n          }\n        ]\n      },\n      "recipients": {\n        "data": [\n          {\n            "id": "r6lbekg8rv5ozyad"\n          }\n        ]\n      },\n      "store": {\n        "data": {\n          "id": "r6lbekg8rv5ozyad"\n        }\n      }\n    }\n  ]\n}\n')),(0,i.kt)("h2",{id:"caching"},"Caching"),(0,i.kt)("p",null,"L5 Repository supports caching of queries.\nThis feature is ",(0,i.kt)("inlineCode",{parentName:"p"},"disabled")," by default.\nYou can enable caching in the ",(0,i.kt)("inlineCode",{parentName:"p"},"app/Ship/Configs/repository.php")," config or the ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},"'cache' => [\n    'enabled' => true,\n],\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dotenv"},"ELOQUENT_QUERY_CACHE=true\n")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"As per the L5 Repository documentation,\nyou need to implement the ",(0,i.kt)("inlineCode",{parentName:"p"},"CacheableRepository")," interface\nand use the ",(0,i.kt)("inlineCode",{parentName:"p"},"CacheableRepositoryTrait")," trait in your repository class to enable caching.\nHowever, Apiato already implements these two requirements in the parent ",(0,i.kt)("inlineCode",{parentName:"p"},"Repository")," class,")),(0,i.kt)("h3",{id:"skipping-cache"},"Skipping Cache"),(0,i.kt)("p",null,"You can skip the cache for a specific request by adding the ",(0,i.kt)("inlineCode",{parentName:"p"},"?skipCache=true")," query parameter to the request URL."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"?skipCache=true\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"It's not recommended to skip the cache, but it's useful for testing purposes.")))}c.isMDXComponent=!0}}]);