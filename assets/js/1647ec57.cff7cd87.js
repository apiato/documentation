"use strict";(self.webpackChunkapiato_documentation=self.webpackChunkapiato_documentation||[]).push([[9317],{15784:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>l});var o=n(74848),r=n(28453);const i={title:"Social Authentication"},s=void 0,a={id:"core-features/social-authentication",title:"Social Authentication",description:"- Default Supported Auth Provide",source:"@site/versioned_docs/version-9.x/core-features/social-authentication.md",sourceDirName:"core-features",slug:"/core-features/social-authentication",permalink:"/docs/9.x/core-features/social-authentication",draft:!1,unlisted:!1,editUrl:"https://github.com/apiato/documentation/tree/master/versioned_docs/version-9.x/core-features/social-authentication.md",tags:[],version:"9.x",lastUpdatedBy:"Moslem Deris",lastUpdatedAt:1618748235e3,frontMatter:{title:"Social Authentication"},sidebar:"docs",previous:{title:"User Registration",permalink:"/docs/9.x/core-features/user-registration"},next:{title:"Query Parameters",permalink:"/docs/9.x/core-features/query-parameters"}},c={},l=[{value:"Default Supported Auth Provide",id:"default-supported-auth-provide",level:2},{value:"How Social Authentication Works",id:"how-social-authentication-works",level:2},{value:"Setup Social Authentication",id:"setup-social-authentication",level:2},{value:"Support new Auth Provider",id:"support-new-auth-provide",level:2}];function d(e){const t={a:"a",code:"code",em:"em",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"#default-supported-auth-provide",children:"Default Supported Auth Provide"})}),"\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"#how-social-authentication-works",children:"How Social Authentication Works"})}),"\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"#setup-social-authentication",children:"Setup Social Authentication"})}),"\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"#support-new-auth-provide",children:"Support new Auth Provide"})}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["For Social Authentication Apiato uses ",(0,o.jsx)(t.a,{href:"https://github.com/laravel/socialite",children:"Socialite"}),"."]}),"\n",(0,o.jsx)(t.h2,{id:"default-supported-auth-provide",children:"Default Supported Auth Provide"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Facebook"}),"\n",(0,o.jsx)(t.li,{children:"Twitter"}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"how-social-authentication-works",children:"How Social Authentication Works"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"The Client (Mobile or Web) sends a request to the Social Auth Provider (Facebook, Twitter..)."}),"\n",(0,o.jsx)(t.li,{children:"The Social Auth Provider returns a Code (Tokens)."}),"\n",(0,o.jsx)(t.li,{children:"The Client makes a call to the server (our server) and passes the Code (Tokens) retrieved from the Provider."}),"\n",(0,o.jsx)(t.li,{children:"The Server fetches the user data from the Social Auth Provider using the received Code (Tokens)."}),"\n",(0,o.jsx)(t.li,{children:"The Server create new User from the collected social data and return the Authenticated User (If the user already created then it just returns it)."}),"\n"]}),"\n",(0,o.jsx)(t.h2,{id:"setup-social-authentication",children:"Setup Social Authentication"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"Create an App on the supported Social Auth provider."}),"\n"]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["For Facebook: ",(0,o.jsx)(t.a,{href:"https://developers.facebook.com/apps",children:"https://developers.facebook.com/apps"})]}),"\n",(0,o.jsxs)(t.li,{children:["For Twitter: ",(0,o.jsx)(t.a,{href:"https://apps.twitter.com/app",children:"https://apps.twitter.com/app"})]}),"\n",(0,o.jsxs)(t.li,{children:["For Google: ",(0,o.jsx)(t.a,{href:"https://console.developers.google.com/apis/credentials",children:"https://console.developers.google.com/apis/credentials"})]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["For the callback URL you can use this Apiato web endpoint ",(0,o.jsx)(t.code,{children:"http://apiato.test/auth/{provider}/callback"})," ",(0,o.jsxs)(t.em,{children:["(replace the provider with any of the supported providers ",(0,o.jsx)(t.code,{children:"facebook"}),", ",(0,o.jsx)(t.code,{children:"twitter"}),",..)"]}),"."]}),"\n",(0,o.jsxs)(t.ol,{start:"2",children:["\n",(0,o.jsxs)(t.li,{children:["Set the Tokens and Secrets in the ",(0,o.jsx)(t.code,{children:".env"})," file"]}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"    'facebook' => [\n        'client_id'     => env('AUTH_FACEBOOK_CLIENT_ID'), // App ID\n        'client_secret' => env('AUTH_FACEBOOK_CLIENT_SECRET'), // App Secret\n        'redirect'      => env('AUTH_FACEBOOK_CLIENT_REDIRECT'),\n    ],\n\n    'twitter' => [\n        'client_id'     => env('AUTH_TWITTER_CLIENT_ID'), // Consumer Key (API Key)\n        'client_secret' => env('AUTH_TWITTER_CLIENT_SECRET'), // Consumer Secret (API Secret)\n        'redirect'      => env('AUTH_TWITTER_CLIENT_REDIRECT'),\n    ],\n\n    'google' => [\n        'client_id'     => env('AUTH_GOOGLE_CLIENT_ID'), // Client ID\n        'client_secret' => env('AUTH_GOOGLE_CLIENT_SECRET'), // Client secret\n        'redirect'      => env('AUTH_GOOGLE_CLIENT_REDIRECT'),\n    ],\n"})}),"\n",(0,o.jsxs)(t.ol,{start:"3",children:["\n",(0,o.jsxs)(t.li,{children:["Make a request from your client to get the ",(0,o.jsx)(t.code,{children:"oauth"})," info. ",(0,o.jsx)(t.strong,{children:"Each Social provider returns different response and keys"})]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["For testing purposes Apiato provides a web endpoint (",(0,o.jsx)(t.code,{children:"http://apiato.test/auth/{provider}"})," ) to act as a client."]}),"\n",(0,o.jsxs)(t.p,{children:["Use that endpoint from your browser ",(0,o.jsxs)(t.em,{children:["(replace the provider with any of the supported providers ",(0,o.jsx)(t.code,{children:"facebook"}),", ",(0,o.jsx)(t.code,{children:"twitter"}),",..)"]})," to get the ",(0,o.jsx)(t.code,{children:"oauth"})," info."]}),"\n",(0,o.jsx)(t.p,{children:"Example Twitter Response:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-text",children:'User {\n  tokentoken: "121212121-121212121"\n  tokentokenSecret: "34343434343434343343434343"\n  tokenid: "777777777"\n  tokennickname: "Mahmoud_Zalt"\n  tokenname: "Mahmoud Zalt"\n  tokenemail: null\n  tokenavatar: "http://pbs.twimg.com/profile_images/88888888/PENrcePC_normal.jpg"\n  tokenuser:\n  token"avatar_original": "http://pbs.twimg.com/profile_images/9999999/PENrcePC.jpg"\n}\n'})}),"\n",(0,o.jsx)(t.p,{children:"NOTE: This step should be done by your client App, which could be a Web, Mobile or other kind of client Apps."}),"\n",(0,o.jsxs)(t.ol,{start:"4",children:["\n",(0,o.jsxs)(t.li,{children:["Use the ",(0,o.jsx)(t.code,{children:"oauth"})," info to make a call from your server to the Social Provider in order to get the User info."]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["Example Getting Twitter User: ",(0,o.jsxs)(t.strong,{children:["Twitter requires the ",(0,o.jsx)(t.code,{children:"oauth_token"})," and ",(0,o.jsx)(t.code,{children:"oauth_secret"}),", other Providers might only require the ",(0,o.jsx)(t.code,{children:"oauth_token"})]})]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-text",children:"POST /v1/auth/twitter HTTP/1.1\nHost: api.apiato.test\nContent-Type: application/x-www-form-urlencoded\nAccept: application/json\n\noauth_token=121212121-121212121&oauth_secret=34343434343434343343434343\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Note: For Facebook only send ",(0,o.jsx)(t.code,{children:"oauth_token"})," which is named as ",(0,o.jsx)(t.code,{children:"access_token"})," in facebook response.\nFor more details about parameters checkout the generated documentation or visit ",(0,o.jsx)(t.code,{children:"app/Containers/Socialauth/UI/API/Routes/AuthenticateAll.v1.private.php"})]}),"\n",(0,o.jsxs)(t.ol,{start:"5",children:["\n",(0,o.jsx)(t.li,{children:"The endpoint above should return the User and his Personal Access Token."}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Example Twitter Response:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-json",children:'{\n    "data": {\n        "object": "User",\n        "id": "eqwja3vw94kzmxr0",\n        "name": "Mahmoud Zalt",\n        "email": null,\n        "confirmed": false,\n        "nickname": null,\n        "gender": null,\n        "birth": null,\n        "social_auth_provider": "twitter",\n        "social_id": "42719726",\n        "social_avatar": {\n            "avatar": "http://pbs.twimg.com/profile_images/1111111111/PENrcePC_normal.jpg",\n            "original": null\n        },\n        "created_at": {\n            "date": "2017-10-20 21:45:03.000000",\n            "timezone_type": 3,\n            "timezone": "UTC"\n        },\n        "updated_at": {\n            "date": "2017-10-20 21:45:03.000000",\n            "timezone_type": 3,\n            "timezone": "UTC"\n        },\n        "readable_created_at": "48 minutes ago",\n        "readable_updated_at": "48 minutes ago"\n    },\n    "meta": {\n        "include": [\n            "roles"\n        ],\n        "custom": {\n            "token_type": "personal",\n            "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI..."\n        }\n    }\n}\n'})}),"\n",(0,o.jsx)(t.h2,{id:"support-new-auth-provide",children:"Support new Auth Provider"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["Pick an Auth Provider from the supported providers by ",(0,o.jsx)(t.a,{href:"https://socialiteproviders.github.io/",children:"Socialite"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["\n",(0,o.jsxs)(t.p,{children:["Go to ",(0,o.jsx)(t.code,{children:"app/Containers/Socialauth/Tasks/FindUserSocialProfileTask.php"})," and support your provider."]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>a});var o=n(96540);const r={},i=o.createContext(r);function s(e){const t=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(i.Provider,{value:t},e.children)}}}]);