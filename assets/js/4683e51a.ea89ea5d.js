"use strict";(self.webpackChunkapiato_documentation=self.webpackChunkapiato_documentation||[]).push([[1746],{60289:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var a=i(74848),t=i(28453);const o={title:"Localization"},s=void 0,l={id:"additional-features/apiato-containers/localization",title:"Localization",description:"- Installation",source:"@site/versioned_docs/version-10.x/additional-features/apiato-containers/localization.md",sourceDirName:"additional-features/apiato-containers",slug:"/additional-features/apiato-containers/localization",permalink:"/docs/10.x/additional-features/apiato-containers/localization",draft:!1,unlisted:!1,editUrl:"https://github.com/apiato/documentation/tree/master/versioned_docs/version-10.x/additional-features/apiato-containers/localization.md",tags:[],version:"10.x",lastUpdatedBy:"mohammad-alavi",lastUpdatedAt:1632148034e3,frontMatter:{title:"Localization"},sidebar:"docs",previous:{title:"Social Authentication",permalink:"/docs/10.x/additional-features/apiato-containers/social-authentication"},next:{title:"Payments",permalink:"/docs/10.x/additional-features/apiato-containers/payments"}},r={},c=[{value:"Installation",id:"installation",level:2},{value:"Creating new languages files",id:"create-new-languages-files",level:2},{value:"Support new languages",id:"support-new-languages",level:2},{value:"Select Request Language",id:"select-request-language",level:2},{value:"Translating Strings",id:"translating-strings",level:2},{value:"Example",id:"example",level:4},{value:"Disable Localization",id:"disable-localization",level:2},{value:"Get Available Localizations",id:"get-available-localizations",level:2},{value:"Tests",id:"tests",level:2}];function d(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h2:"h2",h4:"h4",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#installation",children:"Installation"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#create-new-languages-files",children:"Creating new languages files"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#support-new-languages",children:"Support new languages"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#select-request-language",children:"Select Request Language"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#translating-strings",children:"Translating Strings"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#disable-localization",children:"Disable Localization"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#get-available-localizations",children:"Get Available Localizations"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"#tests",children:"Tests"})}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"composer require apiato/localization-container\n"})}),"\n",(0,a.jsx)(n.h2,{id:"create-new-languages-files",children:"Creating new languages files"}),"\n",(0,a.jsxs)(n.p,{children:["Languages file can be placed in any container, not only the Localization Container.",(0,a.jsx)(n.br,{}),"\n","Place language files inside the ",(0,a.jsx)(n.code,{children:"/Resources/Languages"})," folder of your container. For example\n",(0,a.jsx)(n.code,{children:"app/Containers/SectionName/ContainerName/Resources/Languages"}),". You can also place general language files inside the\n",(0,a.jsx)(n.code,{children:"/Resources/Languages"})," folder of the ",(0,a.jsx)(n.code,{children:"Ship"}),"."]}),"\n",(0,a.jsxs)(n.admonition,{type:"note",children:[(0,a.jsx)(n.mdxAdmonitionTitle,{}),(0,a.jsxs)(n.p,{children:["Just create the ",(0,a.jsx)(n.code,{children:"/Resources/Languages"})," folder if it does not exist."]})]}),"\n",(0,a.jsxs)(n.p,{children:["Example languages files are included in the Localization Container at ",(0,a.jsx)(n.code,{children:"app/Containers/Vendor/Localization/Resources/Languages"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"support-new-languages",children:"Support new languages"}),"\n",(0,a.jsxs)(n.admonition,{title:"Instructions",type:"caution",children:[(0,a.jsx)(n.p,{children:"This container works out of the box perfectly but if you want to change its configs or modify the codes you MUST follow these steps:"}),(0,a.jsxs)(n.p,{children:["1- Copy the container from ",(0,a.jsx)(n.code,{children:"Vendor"})," to ",(0,a.jsx)(n.code,{children:"AppSection"})," (or any of your custom sections) of your project",(0,a.jsx)(n.br,{}),"\n","2- Fix the namespaces",(0,a.jsx)(n.br,{}),"\n","3- Remove ",(0,a.jsx)(n.code,{children:"apiato/localization-container"})," dependency from project root composer.json"]})]}),"\n",(0,a.jsxs)(n.p,{children:["All supported languages must be added to the ",(0,a.jsx)(n.code,{children:"supported_languages"})," in ",(0,a.jsx)(n.code,{children:"app/Containers/Vendor/Localization/Configs/vendor-localization.php"}),"\nto prevent users from requesting unsupported languages, as follows:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",children:"    'supported_languages' => [\n        'ar',\n        'en' => [\n            'en-GB',\n            'en-US',\n        ],\n        'es',\n        'fr',\n        'fa',\n    ],\n"})}),"\n",(0,a.jsx)(n.h2,{id:"select-request-language",children:"Select Request Language"}),"\n",(0,a.jsxs)(n.p,{children:["You can select the language of the response by adding the header ",(0,a.jsx)(n.code,{children:"Accept-Language"})," to the request. By default, the\n",(0,a.jsx)(n.code,{children:"Accept-Language"})," is set to the language defined in ",(0,a.jsx)(n.code,{children:"config/app.php"})," ",(0,a.jsx)(n.code,{children:"locale"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Please note that ",(0,a.jsx)(n.code,{children:"Accept-Language"})," only determines, that the client ",(0,a.jsx)(n.em,{children:"would like"})," to get the information in this specific\nlanguage. It is not given, that the API responds in this language!"]}),"\n",(0,a.jsxs)(n.p,{children:["When the ",(0,a.jsx)(n.code,{children:"Accept-Language"})," header is missing, the default locale will be applied."]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["Please be sure that your client does not send an ",(0,a.jsx)(n.code,{children:"Accept-Language"})," header automatically. Some REST clients\n(e.g., ",(0,a.jsx)(n.code,{children:"POSTMAN"}),") automatically add header-fields based on the operating-systems settings. So your ",(0,a.jsx)(n.code,{children:"Accept-Language"})," header\nmay be set automatically without you knowing!"]})}),"\n",(0,a.jsxs)(n.p,{children:["The API will answer with the applied language in the ",(0,a.jsx)(n.code,{children:"Content-Language"})," header of the response."]}),"\n",(0,a.jsxs)(n.p,{children:["If the requested language cannot be resolved (e.g. it is not defined) the API throws an ",(0,a.jsx)(n.code,{children:"UnsupportedLanguageException"})," to tell\nthe client about this."]}),"\n",(0,a.jsx)(n.p,{children:"The overall workflow of the Middleware is as follows:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Extract the ",(0,a.jsx)(n.code,{children:"Accept-Language"})," field from the request header. If none is set, use the default locale from the config file"]}),"\n",(0,a.jsxs)(n.li,{children:["Build a list of all supported localizations based on the configuration of the respective container. If a language\n(top level) contains regions (sub-level), order them like this: ",(0,a.jsx)(n.code,{children:"['en-GB', 'en-US', 'en']"})," (the regions before languages,\nas regions are more specific)"]}),"\n",(0,a.jsxs)(n.li,{children:["Check, if the value from 1) is within the list from 2). If the value is within this list, set it as application language,\nif not throw an ",(0,a.jsx)(n.code,{children:"Exception"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"translating-strings",children:"Translating Strings"}),"\n",(0,a.jsxs)(n.p,{children:["By default, all the Container translation files are namespaced as the camelCase of its Section name + ",(0,a.jsx)(n.code,{children:"@"})," + camelCase of its Container name."]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["Translation files in ",(0,a.jsx)(n.strong,{children:"Ship"}),' folder are exception to this and will be namespaced with the word "',(0,a.jsx)(n.strong,{children:"ship"}),'" instead of section name, e.g. ',(0,a.jsx)(n.code,{children:"__('ship::notifications.welcome')"})]})}),"\n",(0,a.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,a.jsxs)(n.p,{children:["If a translation file called ",(0,a.jsx)(n.code,{children:"notifications"})," is inside ",(0,a.jsx)(n.code,{children:"MySection"})," > ",(0,a.jsx)(n.code,{children:"MyContainer"})," that contains translation for ",(0,a.jsx)(n.code,{children:"welcome"}),'\nlike "Welcome to our store :)". You can access this translation as follows ',(0,a.jsx)(n.code,{children:"__('mySection@myContainer::notifications.welcome')"}),". If\nyou remove the namespace (part before ",(0,a.jsx)(n.code,{children:"::"}),") and try to access it like this\n",(0,a.jsx)(n.code,{children:"__('notifications.welcome')"})," it will not find your translation and will print ",(0,a.jsx)(n.code,{children:"notifications.welcome"})," only."]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["If you try to load a string for a language that is ",(0,a.jsx)(n.strong,{children:"not available"})," (e.g., there is no folder for this language), Apiato\nwill stick to the default one that is defined in ",(0,a.jsx)(n.code,{children:"app.locale"})," config file. This is also true, if the requested locale\nis present in the ",(0,a.jsx)(n.code,{children:"supported_languages"})," array from the configuration file."]})}),"\n",(0,a.jsx)(n.h2,{id:"disable-localization",children:"Disable Localization"}),"\n",(0,a.jsxs)(n.p,{children:["You will need to remove the Localization Middleware, by simply going to ",(0,a.jsx)(n.code,{children:"app/Containers/Vendor/Localization/Providers/MainServiceProvider.php"}),"\nand remove/comment the ",(0,a.jsx)(n.code,{children:"MiddlewareServiceProvider"})," from the ",(0,a.jsx)(n.code,{children:"$serviceProviders"})," property. Or you can just completely remove the container."]}),"\n",(0,a.jsx)(n.h2,{id:"get-available-localizations",children:"Get Available Localizations"}),"\n",(0,a.jsxs)(n.p,{children:["This container provides a convenient way to get all defined localizations. These localizations can be retrieved via ",(0,a.jsx)(n.code,{children:"GET /localizations"}),'\nby default. Note that this route only outputs the "top level" locales, like ',(0,a.jsx)(n.code,{children:"en"})," from the example above. However, if\nspecific regions (e.g., ",(0,a.jsx)(n.code,{children:"en-US"}),") are defined, these will show up in the result as well."]}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"Transformer"})," for the localizations not only provide the ",(0,a.jsx)(n.code,{children:"language"})," (e.g., ",(0,a.jsx)(n.code,{children:"de"}),"), but also outputs the name of the\nlanguage in this specific language (e.g., ",(0,a.jsx)(n.code,{children:"locale_name => Deutsch"}),"). Furthermore, the language name is outputted in the\napplications default name (e.g., configured in ",(0,a.jsx)(n.code,{children:"app.locale"}),"). This would result in ",(0,a.jsx)(n.code,{children:"default_name => German"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["The same applies to the regions that are defined (e.g., ",(0,a.jsx)(n.code,{children:"de-DE"}),"). Consequently, this results in ",(0,a.jsx)(n.code,{children:"locale_name => Deutschland"}),"\nand ",(0,a.jsx)(n.code,{children:"default_name = Germany"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"tests",children:"Tests"}),"\n",(0,a.jsxs)(n.p,{children:["To change the default language in your tests requests. You can set the ",(0,a.jsx)(n.code,{children:"env"})," language in the ",(0,a.jsx)(n.code,{children:"phpunit.xml"})," file."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>l});var a=i(96540);const t={},o=a.createContext(t);function s(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);